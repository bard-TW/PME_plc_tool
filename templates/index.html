<!doctype html>
<html>

<head>
    <title>Modbus Scan</title>
    <!-- jquery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>

    <!-- bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.2/font/bootstrap-icons.css">

    <!-- 表格 -->
    <link href="https://cdn.datatables.net/1.13.2/css/jquery.dataTables.min.css" rel="stylesheet" />
    <script src="https://cdn.datatables.net/1.13.2/js/jquery.dataTables.min.js"></script>
</head>

<body>


    <div class="container-fluid text-center">
        <div class="row">

            <div class="col-lg-5 col-xl-4">
                <h3>Modbus 設定</h3>
                <br>
                <div class="row g-2 my-2">
                    <div class="col-sm-8">
                        <div class="form-floating">
                            <input type="text" class="form-control" id="ip" placeholder="192.168.0.1" value="">
                            <label for="floatingInputGrid">IP</label>
                        </div>
                    </div>
                    <div class="col-sm-4">
                        <div class="form-floating">
                            <input type="number" class="form-control" id="port" placeholder="502" value="502">
                            <label for="floatingInputGrid">Port</label>
                        </div>
                    </div>
                </div>


                <div class="row g-2 my-2">
                    <div class="col-sm-4">
                        <div class="form-floating">
                            <input type="number" class="form-control" id="slave" placeholder="1" value="1">
                            <label for="floatingInputGrid">Slave</label>
                        </div>
                    </div>
                    <div class="col-sm-8">
                        <div class="form-floating">
                            <select class="form-select" id="point_type" aria-label="Floating label select example">
                                <option value="1">01: COIL STATUS</option>
                                <option value="2">02: INPUT STATUS</option>
                                <option selected value="3">03: HOLDING REGISTER</option>
                                <option value="4">04: INPUT REGISTER</option>
                            </select>
                            <label for="point_type">Modbus Point Type</label>
                        </div>
                    </div>
                </div>


                <div class="row g-2 my-2" style="border: 2px solid rgb(128, 236, 255);">
                    <div class="input-group">

                        <label class="input-group-text" for="log1">
                            <input class="form-check-input mt-0" type="checkbox" value=""
                                aria-label="Checkbox for following text input" id="log1" title="紀錄Logs">
                        </label>

                        <div class="form-floating">
                            <input type="text" class="form-control" id="title" placeholder="欄位名稱">
                            <label for="title">logs的欄位名稱</label>
                        </div>
                        <span class="input-group-text" id="basic-addon1" title="及時顯示資料">123456</span>
                    </div>

                    <div class="input-group my-2">
                        <div class="form-floating">
                            <input type="number" class="form-control" id="address" placeholder="點位" value="3000">
                            <label for="title">點位</label>
                        </div>

                        <div class="form-floating">
                            <select class="form-select" id="data_type">
                                <option value="1" selected>Int</option>
                                <option value="2">uInt</option>
                                <option value="3">Float</option>
                            </select>
                            <label for="data_type">資料型態</label>
                        </div>

                        <div class="form-floating">
                            <select class="form-select" id="bit_num">
                                <option value="16">16 bit</option>
                                <option value="32" selected>32 bit</option>
                                <option value="64">64 bit</option>
                            </select>
                            <label for="bit_num">位元</label>
                        </div>
                        <button class="btn btn-outline-danger" type="button"><i class="bi bi-trash-fill"></i></button>
                    </div>
                </div>

                <button type="button" class="btn btn-outline-danger" id="disconnect_modbus_btu" onclick="disconnect_modbus()" disabled>中斷連線</button>
                <button type="button" class="btn btn-outline-info">新增測量</button>
                <button type="button" class="btn btn-outline-primary" id="connect_modbus_btu" onclick="connect_modbus()">連線</button>

            </div>
            <div class="col-lg-7 col-xl-8">
                <h3>Logs 表格</h3>
            </div>
        </div>
    </div>




    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.4.1/socket.io.min.js"></script>
    <script type="text/javascript">
        var socket = io.connect();

        socket.on('status_response', function (data) {
            console.log(data);
            // 在这里处理接收到的数据，可以更新页面内容或执行其他操作
        });


        // 


        socket.on('disconnect', function (data) {
            alert('與伺服器連線中斷，請重新整理頁面')
        });


        // socket.emit('my event', {data: 'I\'m connected!'});
        function connect_modbus() {
            ip = $("#ip").val()
            port = $("#port").val()
            socket.emit("connect_modbus", ip, port);

            // $("#disconnect_modbus_btu").prop("disabled", false);
            // $("#connect_modbus_btu").prop("disabled", true);
        }

        function disconnect_modbus() {
            socket.emit("connect_modbus", "world");
            // $("#disconnect_modbus_btu").prop("disabled", true);
            // $("#connect_modbus_btu").prop("disabled", false);

        }







    </script>
</body>

</html>